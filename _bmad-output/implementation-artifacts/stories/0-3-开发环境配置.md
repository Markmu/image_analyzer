# Story 0-3: 开发环境配置

Status: ready-for-dev

## Story

As a 开发团队,
I want 拥有一致的开发环境和工具配置,
so that 我们可以高效协作并保持代码质量.

## User Outcomes

- 所有开发者使用相同的代码格式和风格
- 代码在提交前自动检查
- VSCode 设置同步
- Git hooks 防止低质量代码进入仓库

## Acceptance Criteria

1. [ ] VSCode 设置正确配置:
   - [ ] .vscode/settings.json 配置编辑器和格式化
   - [ ] .vscode/extensions.json 推荐扩展列表
   - [ ] .vscode/tasks.json 构建任务
2. [ ] ESLint 配置正确:
   - [ ] .eslintrc.json 基础配置
   - [ ] TypeScript 规则
   - [ ] React 规则
   - [ ] Tailwind CSS 规则（如使用）
3. [ ] Prettier 配置正确:
   - [ ] .prettierrc 格式化规则
   - [ ] .prettierignore 忽略文件
4. [ ] Git hooks 配置正确:
   - [ ] husky 安装和初始化
   - [ ] lint-staged 配置
   - [ ] pre-commit hook 自动运行 lint
5. [ ] GitHub Actions 本地验证（如需要）:
   - [ ] act 配置（可选，用于本地运行 GitHub Actions）
6. [ ] package.json 脚本配置:
   - [ ] "lint": 运行 ESLint
   - [ ] "format": 运行 Prettier
   - [ ] "format:check": 检查格式
   - [ ] "type-check": 类型检查
7. [ ] 代码示例验证:
   - [ ] 验证 lint 不报错
   - [ ] 验证 format 正确格式化代码
   - [ ] 验证类型检查通过

## Tasks / Subtasks

- [ ] Task 1: 配置 VSCode 设置 (AC: #1)
  - [ ] 1.1 创建 .vscode/settings.json
  - [ ] 1.2 创建 .vscode/extensions.json
  - [ ] 1.3 创建 .vscode/tasks.json
- [ ] Task 2: 配置 ESLint (AC: #2)
  - [ ] 2.1 安装 ESLint 相关依赖
  - [ ] 2.2 创建 .eslintrc.json
  - [ ] 2.3 创建 .eslintignore
- [ ] Task 3: 配置 Prettier (AC: #3)
  - [ ] 3.1 安装 Prettier
  - [ ] 3.2 创建 .prettierrc
  - [ ] 3.3 创建 .prettierignore
- [ ] Task 4: 配置 Git hooks (AC: #4)
  - [ ] 4.1 初始化 husky
  - [ ] 4.2 配置 lint-staged
  - [ ] 4.3 创建 pre-commit hook
- [ ] Task 5: 配置 package.json 脚本 (AC: #6)
  - [ ] 5.1 添加 lint 脚本
  - [ ] 5.2 添加 format 脚本
  - [ ] 5.3 添加 format:check 脚本
  - [ ] 5.4 添加 type-check 脚本
- [ ] Task 6: 验证配置 (AC: #7)
  - [ ] 6.1 运行 lint 检查
  - [ ] 6.2 运行格式检查
  - [ ] 6.3 运行类型检查

## Dev Notes

### VSCode 配置

```json
// .vscode/settings.json
{
  "editor.formatOnSave": true,
  "editor.defaultFormatter": "esbenp.prettier-vscode",
  "editor.codeActionsOnSave": {
    "source.fixAll.eslint": true
  },
  "typescript.preferences.importModuleSpecifier": "non-relative",
  "tailwindCSS.experimental.classRegex": [
    ["cva\\(([^)]*)\\)", "[\"'`]([^\"'`]*).*?[\"'`]"],
    ["cn\\(([^)]*)\\)", "[\"'`]([^\"'`]*).*?[\"'`]"]
  ]
}
```

```json
// .vscode/extensions.json
{
  "recommendations": [
    "esbenp.prettier-vscode",
    "dbaeumer.vscode-eslint",
    "bradlc.vscode-tailwindcss",
    "formulahendry.auto-rename-tag",
    "dsznajder.es7-react-js-snippets"
  ]
}
```

### ESLint 配置

```json
{
  "extends": [
    "next/core-web-vitals",
    "plugin:@typescript-eslint/recommended",
    "plugin:react-hooks/recommended",
    "prettier"
  ],
  "rules": {
    "@typescript-eslint/no-unused-vars": "warn",
    "react-hooks/exhaustive-deps": "warn"
  }
}
```

### Prettier 配置

```json
{
  "semi": true,
  "singleQuote": true,
  "tabWidth": 2,
  "trailingComma": "es5",
  "printWidth": 100,
  "bracketSpacing": true
}
```

### Git Hooks 配置

```bash
# 初始化 husky
npx husky install

# 添加 pre-commit hook
npx husky add .husky/pre-commit "npx lint-staged"
```

```json
// package.json
{
  "lint-staged": {
    "*.{js,jsx,ts,tsx}": ["eslint --fix", "prettier --write"],
    "*.{json,md,css}": ["prettier --write"]
  }
}
```

### package.json 脚本

```json
{
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "next lint",
    "format": "prettier --write .",
    "format:check": "prettier --check .",
    "type-check": "tsc --noEmit"
  }
}
```

### 命名规范

| 类别        | 规则          | 示例                               |
| ----------- | ------------- | ---------------------------------- |
| 配置文件    | dot-prefixed  | `.eslintrc.json`, `.prettierrc`    |
| VSCode 配置 | .vscode/ 目录 | `settings.json`, `extensions.json` |

### Project Structure Notes

```
.vscode/
├── settings.json       # VSCode 设置
├── extensions.json     # 推荐扩展
└── tasks.json          # 构建任务

.eslintrc.json
.eslintignore
.prettierrc
.prettierignore
.husky/
└── pre-commit
```

### References

- 命名规范: [architecture.md#naming-patterns](_bmad-output/planning-artifacts/architecture.md#naming-patterns)
- 代码组织: [architecture.md#structure-patterns](_bmad-output/planning-artifacts/architecture.md#structure-patterns)

## Dev Agent Record

### Agent Model Used

Claude Sonnet 4.5

### Debug Log References

### Completion Notes List

### File List

- `.vscode/settings.json`
- `.vscode/extensions.json`
- `.vscode/tasks.json`
- `.eslintrc.json`
- `.eslintignore`
- `.prettierrc`
- `.prettierignore`
- `.husky/pre-commit`
