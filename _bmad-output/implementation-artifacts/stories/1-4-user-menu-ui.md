# Story 1.4: ç”¨æˆ·èœå• UI

Status: backlog

## Epic ä¸Šä¸‹æ–‡

**Epic 1**: ç”¨æˆ·è®¤è¯ä¸è´¦æˆ·ç³»ç»Ÿ

**Epic ç›®æ ‡**: ç”¨æˆ·å¯ä»¥ä½¿ç”¨ Google è´¦æˆ·ç™»å½•ç³»ç»Ÿï¼Œç®¡ç†ä¸ªäººèµ„æ–™å’Œç§¯åˆ†ä½™é¢ã€‚

**Epic èŒƒå›´**:
- Google OAuth 2.0 ç™»å½•é›†æˆ
- æ–°ç”¨æˆ·è‡ªåŠ¨è·èµ  30 credit
- è´¦æˆ·ä¿¡æ¯æŸ¥çœ‹ï¼ˆä½™é¢ã€è®¢é˜…çŠ¶æ€ï¼‰
- è´¦æˆ·åˆ é™¤åŠŸèƒ½

**Epic å†…æ•…äº‹ä¾èµ–**:
- Story 1-1 (OAuth åŸºç¡€è®¾ç½®): **å‰ç½®ä¾èµ–** - å¿…é¡»å…ˆå®Œæˆ
- Story 1-2 (ç”¨æˆ·æ³¨å†Œä¸å¥–åŠ±): **å‰ç½®ä¾èµ–** - éœ€è¦ Credit æ•°æ®å¯ç”¨
- Story 1-3 (ä¼šè¯ç®¡ç†): **å‰ç½®ä¾èµ–** - éœ€è¦ç™»å‡ºåŠŸèƒ½
- Story 1-4 (å½“å‰æ•…äº‹): å®ç°ç”¨æˆ·èœå• UI
- Story 1-5 (è´¦æˆ·åˆ é™¤): å¯åç»­å¼€å‘

## Story

ä½œä¸º **ç™»å½•ç”¨æˆ·**ï¼Œ
æˆ‘æƒ³è¦ **æŸ¥çœ‹æˆ‘çš„è´¦æˆ·ä¿¡æ¯ï¼ˆå¤´åƒã€åç§°ã€Credit ä½™é¢ã€è®¢é˜…çŠ¶æ€ï¼‰**ï¼Œ
ä»¥ä¾¿ **äº†è§£æˆ‘çš„å½“å‰è´¦æˆ·çŠ¶æ€å’Œå‰©ä½™ä½¿ç”¨é¢åº¦**ã€‚

## éªŒæ”¶æ ‡å‡†

### åŠŸèƒ½éªŒæ”¶æ ‡å‡†

1. **[AC-1] ç”¨æˆ·å¤´åƒæ˜¾ç¤º**
   - é¡¶éƒ¨å¯¼èˆªæ å³ä¾§æ˜¾ç¤ºç”¨æˆ·å¤´åƒ
   - å¤´åƒä¸ºåœ†å½¢ï¼Œ48x48px
   - ç‚¹å‡»å¤´åƒå±•å¼€ç”¨æˆ·èœå•
   - ä½¿ç”¨ Google OAuth æä¾›çš„å¤´åƒ URL

2. **[AC-2] ç”¨æˆ·èœå•å±•å¼€**
   - ç‚¹å‡»å¤´åƒåæ˜¾ç¤ºä¸‹æ‹‰èœå•
   - ä½¿ç”¨ MUI Menu ç»„ä»¶
   - èœå•ä½ç½®ï¼šå¤´åƒä¸‹æ–¹å³å¯¹é½
   - ç‚¹å‡»èœå•å¤–éƒ¨è‡ªåŠ¨å…³é—­

3. **[AC-3] ç”¨æˆ·ä¿¡æ¯æ˜¾ç¤º**
   - èœå•é¡¶éƒ¨æ˜¾ç¤ºç”¨æˆ·å¤´åƒï¼ˆå¤§å°ºå¯¸ï¼Œ64x64pxï¼‰
   - æ˜¾ç¤ºç”¨æˆ·åç§°ï¼ˆç²—ä½“ï¼ŒPoppins 600ï¼‰
   - æ˜¾ç¤ºç”¨æˆ· Emailï¼ˆç°è‰²ï¼Œå°å·ï¼ŒOpen Sans 400ï¼‰
   - åˆ†éš”çº¿

4. **[AC-4] Credit ä½™é¢æ˜¾ç¤º**
   - æ˜¾ç¤º Credit ä½™é¢ï¼Œæ ¼å¼ï¼š"30 credits" æˆ– "3 æ¬¡ä½¿ç”¨å‰©ä½™"
   - ä½ç½®ï¼šåˆ†éš”çº¿ä¸‹æ–¹ï¼Œçªå‡ºæ˜¾ç¤º
   - æ ·å¼ï¼šç»¿è‰²ï¼ˆ#22C55Eï¼‰ï¼Œç²—ä½“
   - å®æ—¶ä»æ•°æ®åº“è¯»å–æœ€æ–°ä½™é¢

5. **[AC-5] è®¢é˜…çŠ¶æ€æ˜¾ç¤º**
   - æ˜¾ç¤ºè®¢é˜…ç­‰çº§ï¼ˆ"Free ç­‰çº§" / "Lite ç­‰çº§" / "Standard ç­‰çº§"ï¼‰
   - ä½ç½®ï¼šCredit ä½™é¢ä¸‹æ–¹
   - æ ·å¼ï¼šç°è‰²æ ‡ç­¾ï¼ˆMUI Chipï¼‰
   - å¯ç‚¹å‡»ï¼ˆè·³è½¬åˆ°è®¢é˜…é¡µé¢ï¼Œåç»­ Epic å®ç°ï¼‰

6. **[AC-6] ç™»å‡ºæŒ‰é’®**
   - èœå•åº•éƒ¨æ˜¾ç¤ºç™»å‡ºæŒ‰é’®
   - æ ·å¼ï¼šæ–‡æœ¬æŒ‰é’®ï¼ˆoutlinedï¼‰ï¼Œå·¦ä¾§å¯¹é½
   - ç‚¹å‡»åè°ƒç”¨ç™»å‡ºåŠŸèƒ½ï¼ˆæ¥è‡ª Story 1-3ï¼‰
   - ä½¿ç”¨ SignOutIcon å›¾æ ‡

7. **[AC-7] å“åº”å¼è®¾è®¡**
   - æ¡Œé¢ç«¯ï¼ˆâ‰¥992pxï¼‰ï¼šé¡¶éƒ¨å¯¼èˆªæ å³ä¾§ï¼Œå®Œæ•´èœå•
   - å¹³æ¿ç«¯ï¼ˆ768-991pxï¼‰ï¼šé¡¶éƒ¨å¯¼èˆªæ å³ä¾§ï¼Œå®Œæ•´èœå•
   - ç§»åŠ¨ç«¯ï¼ˆ<768pxï¼‰ï¼šé¡¶éƒ¨å¯¼èˆªæ å³ä¾§ï¼Œç®€åŒ–èœå•

### éåŠŸèƒ½éªŒæ”¶æ ‡å‡†

8. **[AC-8] å“åº”æ—¶é—´**
   - ç”¨æˆ·èœå•å±•å¼€å“åº” < 100ms
   - Credit ä½™é¢åŠ è½½ < 500ms
   - å¤´åƒå›¾ç‰‡åŠ è½½ < 1 ç§’

9. **[AC-9] ç”¨æˆ·ä½“éªŒ**
   - å¤´åƒåŠ è½½å¤±è´¥æ—¶æ˜¾ç¤ºé»˜è®¤å¤´åƒï¼ˆé¦–å­—æ¯ï¼‰
   - èœå•å±•å¼€åŠ¨ç”»æµç•…ï¼ˆ200ms easeï¼‰
   - æ‚¬åœæ•ˆæœï¼šå¤´åƒè½»å¾®ä¸Šæµ®ï¼ˆtranslateY(-2px)ï¼‰

10. **[AC-10] æ— éšœç¢**
    - æ‰€æœ‰å¯äº¤äº’å…ƒç´ å¯é”®ç›˜è®¿é—®
    - ç„¦ç‚¹çŠ¶æ€å¯è§ï¼ˆ2px è“è‰²è¾¹æ¡†ï¼‰
    - ARIA æ ‡ç­¾æ­£ç¡®é…ç½®

## Tasks / Subtasks

### Task 1: åˆ›å»ºç”¨æˆ·èœå•ç»„ä»¶ (AC: 1, 2, 3, 5, 6, 7, 9, 10)

- [ ] 1.1 åˆ›å»º UserMenu ç»„ä»¶ç»“æ„
  - [ ] 1.1.1 åˆ›å»º `src/features/auth/components/UserMenu/index.tsx`
  - [ ] 1.1.2 åˆ›å»º `UserMenu.tsx` ä¸»ç»„ä»¶
  - [ ] 1.1.3 ä½¿ç”¨ MUI Menu ç»„ä»¶å®ç°ä¸‹æ‹‰èœå•

- [ ] 1.2 å®ç°å¤´åƒæ˜¾ç¤º
  - [ ] 1.2.1 åˆ›å»º `UserAvatar` å­ç»„ä»¶
  - [ ] 1.2.2 æ˜¾ç¤ºåœ†å½¢å¤´åƒï¼ˆ48x48pxï¼‰
  - [ ] 1.2.3 åŠ è½½å¤±è´¥æ—¶æ˜¾ç¤ºé»˜è®¤å¤´åƒï¼ˆé¦–å­—æ¯ï¼‰
  - [ ] 1.2.4 æ·»åŠ æ‚¬åœæ•ˆæœï¼ˆè½»å¾®ä¸Šæµ®ï¼‰

- [ ] 1.3 å®ç°ç”¨æˆ·ä¿¡æ¯åŒºåŸŸ
  - [ ] 1.3.1 æ˜¾ç¤ºå¤§å°ºå¯¸å¤´åƒï¼ˆ64x64pxï¼‰
  - [ ] 1.3.2 æ˜¾ç¤ºç”¨æˆ·åç§°ï¼ˆPoppins 600ï¼‰
  - [ ] 1.3.3 æ˜¾ç¤ºç”¨æˆ· Emailï¼ˆOpen Sans 400, ç°è‰²ï¼‰
  - [ ] 1.3.4 æ·»åŠ åˆ†éš”çº¿

- [ ] 1.4 å®ç° Credit ä½™é¢æ˜¾ç¤º
  - [ ] 1.4.1 é›†æˆ `CreditDisplay` ç»„ä»¶ï¼ˆæ¥è‡ª Story 1-2ï¼‰
  - [ ] 1.4.2 æ ¼å¼ï¼š"30 credits" æˆ– "3 æ¬¡ä½¿ç”¨å‰©ä½™"
  - [ ] 1.4.3 æ ·å¼ï¼šç»¿è‰²ï¼ˆ#22C55Eï¼‰ï¼Œç²—ä½“

- [ ] 1.5 å®ç°è®¢é˜…çŠ¶æ€æ˜¾ç¤º
  - [ ] 1.5.1 ä½¿ç”¨ MUI Chip ç»„ä»¶
  - [ ] 1.5.2 æ˜¾ç¤ºæ–‡æœ¬ï¼š"Free ç­‰çº§" / "Lite ç­‰çº§" / "Standard ç­‰çº§"
  - [ ] 1.5.3 æ ·å¼ï¼šç°è‰²èƒŒæ™¯ï¼Œåœ†è§’

- [ ] 1.6 å®ç°ç™»å‡ºæŒ‰é’®
  - [ ] 1.6.1 é›†æˆ `SignOutButton` ç»„ä»¶ï¼ˆæ¥è‡ª Story 1-3ï¼‰
  - [ ] 1.6.2 æ ·å¼ï¼šæ–‡æœ¬æŒ‰é’®ï¼ˆoutlinedï¼‰ï¼Œå·¦ä¾§å¯¹é½
  - [ ] 1.6.3 æ·»åŠ  SignOutIcon å›¾æ ‡

### Task 2: é›†æˆåˆ°å¯¼èˆªæ  (AC: 1, 7, 9)

- [ ] 2.1 ä¿®æ”¹ Header ç»„ä»¶
  - [ ] 2.1.1 æ‰¾åˆ° `src/components/shared/Header/Header.tsx`
  - [ ] 2.1.2 åœ¨å³ä¾§æ·»åŠ  UserMenu ç»„ä»¶
  - [ ] 2.1.3 æœªç™»å½•æ—¶æ˜¾ç¤º"ç™»å½•"æŒ‰é’®ï¼ˆSignInButtonï¼‰

- [ ] 2.2 å“åº”å¼å¸ƒå±€
  - [ ] 2.2.1 æ¡Œé¢ç«¯ï¼šå®Œæ•´èœå•
  - [ ] 2.2.2 å¹³æ¿ç«¯ï¼šå®Œæ•´èœå•
  - [ ] 2.2.3 ç§»åŠ¨ç«¯ï¼šç®€åŒ–èœå•ï¼ˆåªä¿ç•™å¤´åƒå’Œç™»å‡ºï¼‰

### Task 3: å®ç°æ•°æ®è·å– (AC: 4, 8)

- [ ] 3.1 åˆ›å»ºç”¨æˆ·ä¿¡æ¯ API
  - [ ] 3.1.1 åˆ›å»º `src/app/api/user/route.ts`
  - [ ] 3.1.2 å®ç° `GET /api/user` - è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
  - [ ] 3.1.3 è¿”å›æ ¼å¼ï¼š
    ```typescript
    {
      success: true,
      data: {
        id: string,
        email: string,
        name: string,
        image: string,
        creditBalance: number,
        subscriptionTier: 'free' | 'lite' | 'standard'
      }
    }
    ```

- [ ] 3.2 ä½¿ç”¨ React Query è·å–æ•°æ®
  - [ ] 3.2.1 åˆ›å»º `src/features/auth/hooks/useUserInfo.ts`
  - [ ] 3.2.2 ä½¿ç”¨ React Query çš„ `useQuery` è·å–ç”¨æˆ·ä¿¡æ¯
  - [ ] 3.2.3 ç¼“å­˜ç­–ç•¥ï¼šstaleTime 30 ç§’
  - [ ] 3.2.4 è‡ªåŠ¨åˆ·æ–°ï¼šCredit ä½™é¢å˜åŒ–æ—¶

### Task 4: æ ·å¼å’ŒåŠ¨ç”»ä¼˜åŒ– (AC: 9, 10)

- [ ] 4.1 æ·»åŠ å±•å¼€åŠ¨ç”»
  - [ ] 4.1.1 ä½¿ç”¨ MUI Fade ç»„ä»¶
  - [ ] 4.1.2 åŠ¨ç”»æ—¶é•¿ï¼š200ms ease
  - [ ] 4.1.3 å¤´åƒæ‚¬åœæ•ˆæœï¼štranslateY(-2px)

- [ ] 4.2 æ·»åŠ ç„¦ç‚¹çŠ¶æ€
  - [ ] 4.2.1 é”®ç›˜å¯¼èˆªï¼šTab é”®è®¿é—®
  - [ ] 4.2.2 ç„¦ç‚¹æ˜¾ç¤ºï¼š2px è“è‰²è¾¹æ¡†
  - [ ] 4.2.3 ç„¦ç‚¹é™·é˜±ï¼šèœå•æ‰“å¼€æ—¶ç„¦ç‚¹åœ¨èœå•å†…

- [ ] 4.3 é»˜è®¤å¤´åƒå®ç°
  - [ ] 4.3.1 å¤´åƒåŠ è½½å¤±è´¥æ—¶æ˜¾ç¤ºç”¨æˆ·åé¦–å­—æ¯
  - [ ] 4.3.2 åœ†å½¢èƒŒæ™¯ï¼ŒéšæœºæŸ”å’Œé¢œè‰²
  - [ ] 4.3.3 å­—ä½“ï¼šPoppins 600ï¼Œç™½è‰²

### Task 5: æµ‹è¯•å’ŒéªŒè¯ (AC: 1-10)

- [ ] 5.1 å•å…ƒæµ‹è¯•
  - [ ] 5.1.1 æµ‹è¯• UserMenu ç»„ä»¶æ¸²æŸ“
  - [ ] 5.1.2 æµ‹è¯•å¤´åƒåŠ è½½å¤±è´¥æ—¶æ˜¾ç¤ºé»˜è®¤å¤´åƒ
  - [ ] 5.1.3 Mock API å“åº”

- [ ] 5.2 é›†æˆæµ‹è¯•
  - [ ] 5.2.1 æµ‹è¯•ç”¨æˆ·èœå•å±•å¼€å’Œå…³é—­
  - [ ] 5.2.2 æµ‹è¯• Credit ä½™é¢æ­£ç¡®æ˜¾ç¤º
  - [ ] 5.2.3 æµ‹è¯•ç™»å‡ºæŒ‰é’®åŠŸèƒ½

- [ ] 5.3 E2E æµ‹è¯•ï¼ˆä½¿ç”¨ Playwrightï¼‰
  - [ ] 5.3.1 æµ‹è¯•ç‚¹å‡»å¤´åƒå±•å¼€èœå•
  - [ ] 5.3.2 æµ‹è¯•ç”¨æˆ·ä¿¡æ¯æ­£ç¡®æ˜¾ç¤º
  - [ ] 5.3.3 æµ‹è¯• Credit ä½™é¢æ˜¾ç¤º
  - [ ] 5.3.4 æµ‹è¯•è®¢é˜…çŠ¶æ€æ˜¾ç¤º
  - [ ] 5.3.5 æµ‹è¯•ç‚¹å‡»ç™»å‡ºæŒ‰é’®

## Dev Notes

### ç›¸å…³æ¶æ„æ¨¡å¼å’Œçº¦æŸ

**æŠ€æœ¯æ ˆå†³ç­–** ([Source: architecture.md#Core Architectural Decisions](../planning-artifacts/architecture.md)):
- **UI ç»„ä»¶åº“**: MUI + Tailwind CSS
- **çŠ¶æ€ç®¡ç†**: React Query (æœåŠ¡å™¨çŠ¶æ€)
- **æ ·å¼**: Glassmorphism è§†è§‰é£æ ¼

**å‘½åè§„èŒƒ** ([Source: architecture.md#Naming Patterns](../planning-artifacts/architecture.md)):
- React ç»„ä»¶: `UserMenu`, `UserAvatar`, `CreditDisplay` (PascalCase)
- æ–‡ä»¶å: `user-menu.tsx`, `user-avatar.tsx` (kebab-case)
- å‡½æ•°/å˜é‡: `useUserInfo`, `creditBalance` (camelCase)

### UX è®¾è®¡è§„èŒƒ

**ç”¨æˆ·èœå•è®¾è®¡** ([Source: UX Design Specification](../planning-artifacts/ux-design-specification.md)):

**èœå•å¸ƒå±€**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [å¤§å¤´åƒ 64x64px]  å¼ ä¸‰           â”‚
â”‚  zhangsan@example.com            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  ğŸ’° 30 credits                   â”‚  â† ç»¿è‰²çªå‡º
â”‚  ğŸ·ï¸ Free ç­‰çº§                    â”‚  â† ç°è‰²æ ‡ç­¾
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  ğŸšª ç™»å‡º                         â”‚  â† æ–‡æœ¬æŒ‰é’®
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ ·å¼è§„èŒƒ**:
- å­—ä½“ï¼šç”¨æˆ·åç§° Poppins 600ï¼ŒEmail Open Sans 400
- é¢œè‰²ï¼šCredit ç»¿è‰² #22C55Eï¼Œè®¢é˜…çŠ¶æ€ç°è‰² #94A3B8
- é—´è·ï¼šèœå•å†…è¾¹è· 16pxï¼Œå…ƒç´ é—´è· 8px
- åœ†è§’ï¼šèœå• 8pxï¼Œå¤´åƒ 50%ï¼ˆåœ†å½¢ï¼‰
- é˜´å½±ï¼š`box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15)`

**å“åº”å¼æ–­ç‚¹**:
```css
/* ç§»åŠ¨ç«¯ */
@media (max-width: 767px) {
  .user-menu {
    position: fixed;
    top: 60px;
    right: 0;
    width: 100%;
    max-height: calc(100vh - 60px);
  }
}

/* å¹³æ¿ç«¯å’Œæ¡Œé¢ç«¯ */
@media (min-width: 768px) {
  .user-menu {
    min-width: 280px;
  }
}
```

### ç»„ä»¶å®ç°ç¤ºä¾‹

**UserMenu ç»„ä»¶**:
```typescript
// src/features/auth/components/UserMenu/UserMenu.tsx
import { useState } from 'react';
import {
  Menu,
  MenuItem,
  Avatar,
  Typography,
  Divider,
  Chip,
  Box,
} from '@mui/material';
import { SignOut as SignOutIcon } from '@mui/icons-material';
import { useUserInfo } from '../../hooks/useUserInfo';
import { CreditDisplay } from '@/features/credits/components/CreditDisplay';
import { SignOutButton } from '../SignOutButton';

export function UserMenu() {
  const [anchorEl, setAnchorEl] = useState<null | HTMLElement>(null);
  const open = Boolean(anchorEl);
  const { data: user, isLoading } = useUserInfo();

  const handleClick = (event: React.MouseEvent<HTMLElement>) => {
    setAnchorEl(event.currentTarget);
  };

  const handleClose = () => {
    setAnchorEl(null);
  };

  if (isLoading || !user) {
    return null;
  }

  return (
    <>
      <Avatar
        src={user.image}
        alt={user.name}
        onClick={handleClick}
        sx={{
          width: 48,
          height: 48,
          cursor: 'pointer',
          '&:hover': {
            transform: 'translateY(-2px)',
            transition: 'transform 0.2s ease',
          },
        }}
      >
        {user.name?.charAt(0).toUpperCase()}
      </Avatar>

      <Menu
        anchorEl={anchorEl}
        open={open}
        onClose={handleClose}
        slotProps={{
          paper: {
            sx: {
              minWidth: 280,
              mt: 1,
            },
          },
        }}
      >
        {/* ç”¨æˆ·ä¿¡æ¯åŒºåŸŸ */}
        <Box sx={{ p: 2, textAlign: 'center' }}>
          <Avatar
            src={user.image}
            alt={user.name}
            sx={{ width: 64, height: 64, mb: 1 }}
          >
            {user.name?.charAt(0).toUpperCase()}
          </Avatar>
          <Typography variant="subtitle1" fontWeight={600}>
            {user.name}
          </Typography>
          <Typography variant="body2" color="text.secondary">
            {user.email}
          </Typography>
        </Box>

        <Divider />

        {/* Credit ä½™é¢ */}
        <MenuItem disabled>
          <CreditDisplay balance={user.creditBalance} />
        </MenuItem>

        {/* è®¢é˜…çŠ¶æ€ */}
        <MenuItem disabled>
          <Chip
            label={`${user.subscriptionTier} ç­‰çº§`}
            size="small"
            color="default"
          />
        </MenuItem>

        <Divider />

        {/* ç™»å‡ºæŒ‰é’® */}
        <MenuItem onClick={handleClose}>
          <SignOutButton />
        </MenuItem>
      </Menu>
    </>
  );
}
```

**useUserInfo Hook**:
```typescript
// src/features/auth/hooks/useUserInfo.ts
import { useQuery } from '@tanstack/react-query';

interface UserInfo {
  id: string;
  email: string;
  name: string;
  image: string;
  creditBalance: number;
  subscriptionTier: 'free' | 'lite' | 'standard';
}

export function useUserInfo() {
  return useQuery<UserInfo>({
    queryKey: ['user', 'info'],
    queryFn: async () => {
      const res = await fetch('/api/user');
      if (!res.ok) {
        throw new Error('Failed to fetch user info');
      }
      const data = await res.json();
      return data.data;
    },
    staleTime: 30 * 1000, // 30 ç§’
  });
}
```

### Glassmorphism æ ·å¼å®ç°

**èœå•æ ·å¼**:
```css
.user-menu {
  background: rgba(30, 41, 59, 0.95); /* Slate 800, 95% é€æ˜åº¦ */
  backdrop-filter: blur(12px);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 8px;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
}
```

### æ— éšœç¢è€ƒè™‘

**ARIA æ ‡ç­¾**:
```typescript
<Avatar
  aria-label="ç”¨æˆ·èœå•"
  aria-haspopup="true"
  aria-expanded={open}
  onClick={handleClick}
>
  {user.name?.charAt(0).toUpperCase()}
</Avatar>

<Menu
  id="user-menu"
  aria-labelledby="user-menu-button"
  anchorEl={anchorEl}
  open={open}
  onClose={handleClose}
>
```

**é”®ç›˜å¯¼èˆª**:
- Tab é”®ï¼šèšç„¦åˆ°å¤´åƒ
- Enter/Spaceï¼šå±•å¼€èœå•
- æ–¹å‘é”®ï¼šåœ¨èœå•é¡¹ä¸­å¯¼èˆª
- Escï¼šå…³é—­èœå•

### PRD éœ€æ±‚æ˜ å°„

**æ¥è‡ª PRD çš„éœ€æ±‚**:
- FR3: ç”¨æˆ·å¯ä»¥åœ¨ç™»å½•åæŸ¥çœ‹å…¶å½“å‰ credit ä½™é¢å’Œè®¢é˜…çŠ¶æ€
- FR4: ç”¨æˆ·å¯ä»¥æŸ¥çœ‹å…¶åŸºæœ¬è´¦æˆ·ä¿¡æ¯

### å¸¸è§é™·é˜±å’Œè§£å†³æ–¹æ¡ˆ

**é—®é¢˜ 1: ç”¨æˆ·ä¿¡æ¯ä¸æ›´æ–°**
- **ç—‡çŠ¶**: Credit ä½™é¢å˜åŒ–åèœå•ä»æ˜¾ç¤ºæ—§å€¼
- **è§£å†³**: ä½¿ç”¨ React Query çš„ `invalidateQueries()` åˆ·æ–°æ•°æ®

**é—®é¢˜ 2: å¤´åƒåŠ è½½æ…¢**
- **ç—‡çŠ¶**: ç”¨æˆ·ç­‰å¾…å¤´åƒåŠ è½½
- **è§£å†³**: å…ˆæ˜¾ç¤ºé»˜è®¤å¤´åƒï¼ˆé¦–å­—æ¯ï¼‰ï¼Œå¤´åƒåŠ è½½å®Œæˆåæ›¿æ¢

**é—®é¢˜ 3: èœå•åœ¨ç§»åŠ¨ç«¯æ˜¾ç¤ºå¼‚å¸¸**
- **ç—‡çŠ¶**: ç§»åŠ¨ç«¯èœå•è¢«æˆªæ–­
- **è§£å†³**: ä½¿ç”¨ `position: fixed` å’Œ `max-height: calc(100vh - 60px)`

**é—®é¢˜ 4: é”®ç›˜æ— æ³•è®¿é—®**
- **ç—‡çŠ¶**: Tab é”®æ— æ³•èšç„¦åˆ°å¤´åƒ
- **è§£å†³**: ç¡®ä¿å¤´åƒæœ‰ `tabIndex={0}` å’Œé”®ç›˜äº‹ä»¶å¤„ç†å™¨

## Dev Agent Record

### Completion Notes List

- âœ… ä»åŸå§‹ Story 1-1 æ‹†åˆ†ç”¨æˆ·èœå• UI éƒ¨åˆ†
- âœ… ä¸“æ³¨äºç”¨æˆ·ä¿¡æ¯å±•ç¤ºå’Œäº¤äº’
- âœ… å®šä¹‰äº†è¯¦ç»†çš„ UI è§„èŒƒå’Œæ ·å¼
- âœ… åŒ…å«äº†å“åº”å¼è®¾è®¡å’Œæ— éšœç¢
- âœ… æä¾›äº†å®Œæ•´çš„ç»„ä»¶å®ç°ç¤ºä¾‹
- âœ… æ·»åŠ äº† React Query æ•°æ®è·å–

### File List

**å¾…åˆ›å»º/ä¿®æ”¹çš„æ–‡ä»¶**:

1. `src/features/auth/components/UserMenu/index.tsx` - ç”¨æˆ·èœå•ç»„ä»¶ï¼ˆæ–°å¢ï¼‰
2. `src/features/auth/components/UserMenu/UserMenu.tsx` - ä¸»ç»„ä»¶ï¼ˆæ–°å¢ï¼‰
3. `src/features/auth/components/UserMenu/UserMenu.test.tsx` - æµ‹è¯•ï¼ˆæ–°å¢ï¼‰
4. `src/features/auth/components/UserAvatar/index.tsx` - å¤´åƒç»„ä»¶ï¼ˆæ–°å¢ï¼‰
5. `src/features/auth/hooks/useUserInfo.ts` - ç”¨æˆ·ä¿¡æ¯ Hookï¼ˆæ–°å¢ï¼‰
6. `src/app/api/user/route.ts` - ç”¨æˆ·ä¿¡æ¯ APIï¼ˆæ–°å¢ï¼‰
7. `src/components/shared/Header/Header.tsx` - å¯¼èˆªæ ï¼ˆä¿®æ”¹ï¼‰

---

**Story ç”Ÿæˆå®Œæˆæ—¶é—´**: 2026-02-04

**å‰ç½®ä¾èµ–**:
- Story 1-1 (OAuth åŸºç¡€è®¾ç½®) - å¿…é¡»å…ˆå®Œæˆ
- Story 1-2 (ç”¨æˆ·æ³¨å†Œä¸å¥–åŠ±) - éœ€è¦ Credit æ•°æ®
- Story 1-3 (ä¼šè¯ç®¡ç†) - éœ€è¦ç™»å‡ºåŠŸèƒ½

**ä¸‹ä¸€æ­¥**:
1. ç­‰å¾…å‰ç½® Story å®Œæˆ
2. Review this story file
3. Run dev agent's `dev-story` for implementation
4. After completion, Epic 1 çš„ UI éƒ¨åˆ†å®Œæˆ
